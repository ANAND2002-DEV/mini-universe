<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mini Universe â€“ Stable Orbits</title>
<style>
body { margin:0; overflow:hidden; background:black; }
canvas { display:block; }
</style>
</head>
<body>

<script type="module">
import * as THREE from './three/three.module.min.js';
import { OrbitControls } from './three/OrbitControls.js';

/* SCENE */
const scene = new THREE.Scene();

/* CAMERA */
const camera = new THREE.PerspectiveCamera(60, innerWidth/innerHeight, 0.1, 10000);
camera.position.set(0, 300, 700);

/* RENDERER */
const renderer = new THREE.WebGLRenderer({ antialias:true });
renderer.setSize(innerWidth, innerHeight);
renderer.setPixelRatio(devicePixelRatio);
renderer.outputEncoding = THREE.sRGBEncoding;
document.body.appendChild(renderer.domElement);

/* CONTROLS */
const controls = new OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;
controls.dampingFactor = 0.06;
controls.minDistance = 15;
controls.maxDistance = 6000;

/* LIGHTS */
scene.add(new THREE.AmbientLight(0xffffff, 0.45));

const sunLight = new THREE.PointLight(0xffffff, 9, 9000);
sunLight.position.set(0,0,0);
scene.add(sunLight);

const rimLight = new THREE.DirectionalLight(0xffffff, 1.2);
rimLight.position.set(-400, 300, -500);
scene.add(rimLight);

/* STARS */
const starsGeo = new THREE.BufferGeometry();
const stars = [];
for(let i=0;i<20000;i++){
  stars.push(
    (Math.random()-0.5)*8000,
    (Math.random()-0.5)*8000,
    (Math.random()-0.5)*8000
  );
}
starsGeo.setAttribute('position', new THREE.Float32BufferAttribute(stars,3));
scene.add(new THREE.Points(
  starsGeo,
  new THREE.PointsMaterial({ color:0xffffff, size:1 })
));

/* TEXTURES */
const loader = new THREE.TextureLoader();

/* SUN */
const sun = new THREE.Mesh(
  new THREE.SphereGeometry(35,64,64),
  new THREE.MeshBasicMaterial({
    map: loader.load('./assets/planets/sun.jpg')
  })
);
scene.add(sun);
controls.target.copy(sun.position);

/* PLANET DATA */
const planetData = [
  {tex:'mercury.jpg', r:4, d:90,  speed:0.045},
  {tex:'venus.jpg',   r:6, d:130, speed:0.038},
  {tex:'earth.jpg',   r:6.5,d:175, speed:0.03},
  {tex:'mars.jpg',    r:5.5,d:220, speed:0.025},
  {tex:'jupiter.jpg', r:16, d:300, speed:0.018},
  {tex:'saturn.jpg',  r:14, d:380, speed:0.014},
  {tex:'uranus.jpg',  r:11, d:460, speed:0.011},
  {tex:'neptune.jpg', r:11, d:540, speed:0.009}
];

const systems = [];

/* CREATE PLANETS */
planetData.forEach((p,i)=>{

  const pivot = new THREE.Object3D();
  pivot.rotation.x = Math.PI/2 + (Math.random()-0.5)*0.25;
  pivot.rotation.y = Math.random()*Math.PI*2;
  scene.add(pivot);

  /* ORBIT RING */
  const ring = new THREE.Mesh(
    new THREE.RingGeometry(p.d-0.6, p.d+0.6, 128),
    new THREE.MeshBasicMaterial({
      color:0xffffff,
      transparent:true,
      opacity:0.3,
      side:THREE.DoubleSide
    })
  );
  ring.rotation.x = Math.PI/2;
  scene.add(ring);

  /* PLANET */
  const planet = new THREE.Mesh(
    new THREE.SphereGeometry(p.r,48,48),
    new THREE.MeshStandardMaterial({
      map: loader.load('./assets/planets/'+p.tex),
      roughness:0.4,
      metalness:0.05,
      emissive:new THREE.Color(0x111111),
      emissiveIntensity:0.25
    })
  );
  planet.position.x = p.d;
  pivot.add(planet);

  systems.push({pivot, speed:p.speed});
});

/* ANIMATE */
function animate(){
  requestAnimationFrame(animate);
  systems.forEach(s => s.pivot.rotation.z += s.speed*0.01);
  controls.update();
  renderer.render(scene,camera);
}
animate();

/* RESIZE */
addEventListener('resize',()=>{
  camera.aspect = innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth, innerHeight);
});
</script>
</body>
</html>
