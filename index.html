<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mini Universe</title>
<style>
body { margin:0; overflow:hidden; background:black; }
canvas { display:block; }
</style>
</head>
<body>

<script type="module">
import * as THREE from "./three/three.module.min.js";
import { OrbitControls } from "./three/OrbitControls.js";

/* ================= SCENE ================= */
const scene = new THREE.Scene();

/* ================= CAMERA ================= */
const camera = new THREE.PerspectiveCamera(
  70,
  innerWidth / innerHeight,
  0.1,
  20000
);
camera.position.set(0, 25, 140); // ðŸ‘ˆ CENTERED FIX

/* ================= RENDERER ================= */
const renderer = new THREE.WebGLRenderer({ antialias:true });
renderer.setSize(innerWidth, innerHeight);
renderer.outputEncoding = THREE.sRGBEncoding;
renderer.toneMapping = THREE.ACESFilmicToneMapping;
document.body.appendChild(renderer.domElement);

/* ================= CONTROLS ================= */
const controls = new OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;
controls.dampingFactor = 0.06;
controls.enableZoom = true;
controls.minDistance = 20;
controls.maxDistance = 400;
controls.target.set(0,0,0); // ðŸ‘ˆ ALWAYS CENTER ON SUN
controls.update();

/* ================= LIGHT ================= */
scene.add(new THREE.PointLight(0xffffff, 220, 0, 2));
scene.add(new THREE.AmbientLight(0xffffff, 0.8));

/* ================= STAR FIELD ================= */
const starGeo = new THREE.BufferGeometry();
const starPos = [];
for (let i=0;i<14000;i++){
  starPos.push(
    (Math.random()-0.5)*12000,
    (Math.random()-0.5)*12000,
    (Math.random()-0.5)*12000
  );
}
starGeo.setAttribute("position", new THREE.Float32BufferAttribute(starPos,3));
scene.add(new THREE.Points(
  starGeo,
  new THREE.PointsMaterial({ size:1.2, color:0xffffff })
));

/* ================= TEXTURES ================= */
const loader = new THREE.TextureLoader();

/* ================= SUN ================= */
const sun = new THREE.Mesh(
  new THREE.SphereGeometry(9, 64, 64),
  new THREE.MeshBasicMaterial({
    map: loader.load("./assets/planets/sun.jpg")
  })
);
scene.add(sun);

/* ================= PLANETS DATA ================= */
const planetsData = [
 {name:"Mercury", size:1.2, dist:18, speed:0.0009, tex:"mercury.jpg"},
 {name:"Venus",   size:1.7, dist:24, speed:0.0007, tex:"venus.jpg"},
 {name:"Earth",   size:1.9, dist:30, speed:0.0006, tex:"earth.jpg", moons:1},
 {name:"Mars",    size:1.5, dist:36, speed:0.0005, tex:"mars.jpg"},
 {name:"Jupiter", size:3.5, dist:50, speed:0.0003, tex:"jupiter.jpg", moons:4},
 {name:"Saturn",  size:3.1, dist:65, speed:0.00025,tex:"saturn.jpg", moons:3},
 {name:"Uranus",  size:2.6, dist:80, speed:0.0002, tex:"uranus.jpg"},
 {name:"Neptune", size:2.6, dist:95, speed:0.00015,tex:"neptune.jpg"},
 {name:"Pluto",   size:1.2, dist:110,speed:0.0001, tex:"pluto.jpg"},
 {name:"Exoplanet",size:2.2,dist:130,speed:0.00008,tex:"exoplanet.jpg"}
];

const planets = [];

/* ================= PLANETS + ORBITS ================= */
planetsData.forEach(p => {

  // Orbit ring
  const ring = new THREE.Mesh(
    new THREE.RingGeometry(p.dist-0.12, p.dist+0.12, 128),
    new THREE.MeshBasicMaterial({
      color:0xffffff,
      opacity:0.16,
      transparent:true,
      depthWrite:false
    })
  );
  ring.rotation.x = Math.PI/2;
  scene.add(ring);

  const pivot = new THREE.Object3D();
  pivot.rotation.y = Math.random()*Math.PI*2;
  scene.add(pivot);

  const planet = new THREE.Mesh(
    new THREE.SphereGeometry(p.size, 48, 48),
    new THREE.MeshStandardMaterial({
      map: loader.load("./assets/planets/"+p.tex),
      emissive:0x333333,
      emissiveIntensity:0.7
    })
  );
  planet.position.x = p.dist;
  pivot.add(planet);

  // Moons
  const moons = [];
  if (p.moons){
    for(let i=0;i<p.moons;i++){
      const mp = new THREE.Object3D();
      planet.add(mp);

      const moon = new THREE.Mesh(
        new THREE.SphereGeometry(p.size*0.18, 24, 24),
        new THREE.MeshStandardMaterial({ color:0xffffff })
      );
      moon.position.x = p.size*(2 + i*0.7);
      mp.add(moon);
      moons.push(mp);
    }
  }

  planets.push({pivot, planet, moons, speed:p.speed});
});

/* ================= ASTEROID BELT ================= */
const belt = new THREE.Group();
for(let i=0;i<600;i++){
  const rock = new THREE.Mesh(
    new THREE.SphereGeometry(Math.random()*0.15+0.05,8,8),
    new THREE.MeshStandardMaterial({color:0x888888})
  );
  const r = 56 + Math.random()*8;
  const a = Math.random()*Math.PI*2;
  rock.position.set(Math.cos(a)*r, (Math.random()-0.5)*2, Math.sin(a)*r);
  belt.add(rock);
}
scene.add(belt);

/* ================= ANIMATION ================= */
function animate(){
  requestAnimationFrame(animate);

  sun.rotation.y += 0.00025;
  planets.forEach(p=>{
    p.pivot.rotation.y += p.speed;
    p.planet.rotation.y += 0.0007;
    p.moons.forEach((m,i)=>m.rotation.y += 0.001+i*0.0004);
  });

  belt.rotation.y += 0.0002;

  controls.update();
  renderer.render(scene,camera);
}
animate();

/* ================= RESIZE ================= */
addEventListener("resize",()=>{
  camera.aspect = innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth,innerHeight);
});
</script>
</body>
</html>
